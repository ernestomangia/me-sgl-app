@model ME.Libros.Web.Models.LocalidadViewModel

@{
    ViewBag.Title = "Crear";
}

<h3>Nueva localidad</h3>
@using (Html.BeginForm("Crear", "Localidad", FormMethod.Post, new { id = "formLocalidad", @class = "form-horizontal" }))
{
    @Html.ValidationSummary()

    @Html.Partial("Shared/Form_Partial", Model)

    <div class="form-group">
        <div class="col-sm-offset-8">
            <a id="btnCancelarCrear" class="btn btn-default">
                Cancelar
            </a>
            <input type="submit" value="Crear" class="btn btn-success" />
        </div>
    </div>
}

<script>
    $("#btnCancelarCrear").on("click", function () {
        cargarPestaña('@Url.Action("Index", "Localidad")');
    });

    $("#formLocalidad").on("submit", function () {
        event.preventDefault();
        $.ajax({
            method: "POST",
            url: $("#formLocalidad").attr("action"),
            data: $("#formLocalidad").serialize(),
            dataType: "json",
            error: function (text, error) {
                mensajeError("Ha ocurrido un error: " + text + error);
            },
            success: function (data) {
                if (data.success) {
                    mensajeSuccess("La localidad se creó exitosamente");
                    cargarPestaña('@Url.Action("Index", "Localidad")');
                } else {
                    toastr.error(data.mensaje, "Error. Los datos no se guardaron.");
                }
            },
            timeout: 10000,
            cache: false
        });
    });
</script>